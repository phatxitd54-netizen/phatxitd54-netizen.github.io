<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ClearKey LIVE Player</title>

<link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
<script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.compiled.js"></script>

<style>
body {
  background: #000;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
video {
  width: 90%;
  max-width: 960px;
  height: 540px;
  background: #000;
}
</style>
</head>
<body>

<video
  id="video"
  controls
  playsinline
  muted>
</video>

<script>
async function init() {
  const video = document.getElementById("video");

  if (!shaka.Player.isBrowserSupported()) {
    alert("Browser không hỗ trợ DRM");
    return;
  }

  const player = new shaka.Player(video);

  // LOG LỖI CHI TIẾT
  player.addEventListener('error', e => {
    console.error("SHaka error", e.detail);
  });

  // CONFIG LIVE + CLEARKKEY
  player.configure({
    streaming: {
      lowLatencyMode: true,
      bufferingGoal: 10,
      rebufferingGoal: 2
    },
    drm: {
      clearKeys: {
        "dcda1c0511c347f8b89c1821600426ac": "dbc1d4d9244f8e7d01d"
      }
    }
  });

  try {
    await player.load(
      "https://livevlisctcdnw.seenow.vn/livesnv2/THETHAO_HD/manifest.mpd"
    );

    await video.play();
    console.log("✅ ĐANG PHÁT");
  } catch (err) {
    console.error("❌ LOAD FAIL", err);
    alert("Không hiển thị được hình");
  }
}

init();
</script>

</body>
</html>